package controller

/**************************************************************************************************/
/*!
 *  base.go
 *
 *  どのcontrollerでも呼ばれる基底メソッド系
 *  あまりimportさせたくないものをこちらに書く
 *
 */
/**************************************************************************************************/
import (
	"github.com/gin-gonic/gin"

	db "sample/common/db"
	"sample/common/err"
	"sample/common/redis"
)

/**************************************************************************************************/
/*!
 *  DB COMMIT
 */
/**************************************************************************************************/
func dbCommit(c *gin.Context) err.ErrWriter {
	ew := db.Commit(c)
	if ew.HasErr() {
		ew.Write()
	}
	return ew
}

/**************************************************************************************************/
/*!
 *  DB ROLLBACK
 */
/**************************************************************************************************/
func dbRollback(c *gin.Context) err.ErrWriter {
	ew := db.RollBack(c)
	if ew.HasErr() {
		ew.Write()
	}
	return ew
}

/**************************************************************************************************/
/*!
 *  Redis Exec
 */
/**************************************************************************************************/
func redisExec(c *gin.Context) err.ErrWriter {
	_, ew := redis.NewRedisRepo().Exec(c)
	if ew.HasErr() {
		ew.Write()
	}
	return ew
}

/**************************************************************************************************/
/*!
 *  Redis discard
 */
/**************************************************************************************************/
func redisDiscard(c *gin.Context) err.ErrWriter {
	ew := redis.NewRedisRepo().Discard(c)
	if ew.HasErr() {
		ew.Write()
	}
	return ew
}
